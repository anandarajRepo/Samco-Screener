<!DOCTYPE html>
<html>

<head>
    <title>Watchlist</title>
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://drvic10k.github.io/bootstrap-sortable/Contents/bootstrap-sortable.css" />
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

    <!-- Grid Style -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/watchlist/gridstyle.css') }}">

    <!-- Favourite Stock Notification Style -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/watchlist/favouritestock.css') }}">
</head>
<!-- JQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.1/moment.js"></script>
<script src="https://drvic10k.github.io/bootstrap-sortable/Scripts/bootstrap-sortable.js"></script>

<!-- Favourite Stock Notification -->
<script src="{{ url_for('static', filename='js/watchlist/favouritestock.js') }}"></script>

<!-- Generate Subsector -->
<script src="{{ url_for('static', filename='js/watchlist/SubsectorGenrator.js') }}"></script>

<body>
    <br />
    <form id="form-watchlist" class="form-inline" method="POST" action="{{ url_for('home') }}">
        <div class="row g-3 align-items-center">
            <div class="col-auto mb-3">
                <select class="form-select form-select-sm" id="sector-dropdown" name="sector-dropdown"
                    aria-label="Default select example">
                    <option value="">Choose Sector</option>
                    {% for sectorDetails in listOfSectors %}
                    <option {% if selectedSector==sectorDetails['sector'] %} Selected {% endif %}
                        value="{{sectorDetails['sector']}}">{{sectorDetails['sector']}}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-auto mb-3">
                <select class="form-select form-select-sm" id="sub-category-dropdown" name="sub-category-dropdown"
                    aria-label="Default select example">
                    <option value="">Choose Sub-Sector</option>
                    {% for subSectorDetails in listOfSubSectors %}
                    <option {% if selectedSubSector==subSectorDetails['subsector'] %} Selected {% endif %}
                        value="{{subSectorDetails['subsector']}}">{{subSectorDetails['subsector']}}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-auto mb-3">
                <button type="submit" class="btn btn-outline-primary btn-sm">Search</button>
            </div>
            <div class="col-lg-4 col-lg-offset-4 mb-3 form-group has-feedback has-search">
                <span class="glyphicon glyphicon-search form-control-feedback"></span>
                <input type="text" class="form-control" placeholder="Search Company Name Here" id="search-bar" name="search-bar">
            </div>
        </div>
    </form>
    <br />

    <script>
    document.addEventListener("DOMContentLoaded", function () {
        document.getElementById("search-bar").addEventListener("keypress", function (event) {
            // If the user presses the "Enter" key on the keyboard
            // (13 is the "Enter" key code), run myFunction
            if (event.keyCode === 13) {
                event.preventDefault();
                document.getElementById("form-watchlist").submit();
            }
        });
    });
    </script>

    <table id="stocktable" class="table table-bordered table-sm sortable">
        <thead>
            <tr>
                <th scope="col">ID</th>
                <th scope="col">Symbol</th>
                <th scope="col">Company</th>
                <th scope="col">Sector</th>
                <th scope="col">Sub-Sector</th>
                <th scope="col">DateOfListing</th>
                <th scope="col">MktCap (in Cr)</th>
                <th scope="col">LTP</th>
                <th scope="col">1D %</th>
                <th scope="col">1W %</th>
                <th scope="col">1M %</th>
                <th scope="col">3M %</th>
                <th scope="col">6M %</th>
                <th scope="col">1Y %</th>
            </tr>
        </thead>
        <tbody>
            {% for stockDetails in listOfStocks %}
            <tr {% if stockDetails['favourite']==true %} class="table-secondary" {% endif %}>
                <td><input type="checkbox" class="get_value" name="insturmentId" value="{{stockDetails['id']}}" {% if stockDetails['favourite']==true %} checked {% endif %}></td>
                <td scope="row"><b>{{stockDetails['symbol']}}</b></td>
                <td scope="row"><b>{{stockDetails['nameofcompany']}}</b></td>
                <td scope="row">{{stockDetails['sector']}}</td>
                <td scope="row">{{stockDetails['subsector']}}</td>
                <td scope="row">{{stockDetails['dateoflistings']}}</td>
                <td scope="row" data-value="{{stockDetails['marketcapincrs']}}">{{stockDetails['marketcap']}}</td>
                <td scope="row">{{stockDetails['LTP']}}</td>
                <td scope="row" {% if stockDetails['1D'] is number and stockDetails['1D']>= 0 %} class="text-success" {%
                    endif %} {% if stockDetails['1D'] is number and stockDetails['1D'] <= 0 %} class="text-danger" {%
                        endif %}><b>{{stockDetails['1D']}}</b></td>
                <td scope="row" {% if stockDetails['1W'] is number and stockDetails['1W']>= 0 %} class="text-success" {%
                    endif %} {% if stockDetails['1W'] is number and stockDetails['1W'] <= 0 %} class="text-danger" {%
                        endif %}><b>{{stockDetails['1W']}}</b></td>
                <td scope="row" {% if stockDetails['1M'] is number and stockDetails['1M']>= 0 %} class="text-success" {%
                    endif %} {% if stockDetails['1M'] is number and stockDetails['1M'] <= 0 %} class="text-danger" {%
                        endif %}><b>{{stockDetails['1M']}}</b></td>
                <td scope="row" {% if stockDetails['3M'] is number and stockDetails['3M']>= 0 %} class="text-success" {%
                    endif %} {% if stockDetails['3M'] is number and stockDetails['3M'] <= 0 %} class="text-danger" {%
                        endif %}><b>{{stockDetails['3M']}}</b></td>
                <td scope="row" {% if stockDetails['6M'] is number and stockDetails['6M']>= 0 %} class="text-success" {%
                    endif %} {% if stockDetails['6M'] is number and stockDetails['6M'] <= 0 %} class="text-danger" {%
                        endif %}><b>{{stockDetails['6M']}}</b></td>
                <td scope="row" {% if stockDetails['1Y'] is number and stockDetails['1Y']>= 0 %} class="text-success" {%
                    endif %} {% if stockDetails['1Y'] is number and stockDetails['1Y'] <= 0 %} class="text-danger" {%
                        endif %}><b>{{stockDetails['1Y']}}</b></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Favorite Stock Notification -->
    <div id="alert-favourite-success" class="alert alert-success alert-dismissible fade hide" role="alert">
        <div id="result-success"></div>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

    <div id="alert-favourite-warning" class="alert alert-warning alert-dismissible fade hide" role="alert">
        <div id="result-warning"></div>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

    <!-- Optional JavaScript; choose one of the two! -->
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
         <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script> -->

    <!--DataTable Sorting reference-->
    <!--https://github.com/drvic10k/bootstrap-sortable
        https://hdtuto.com/article/bootstrap-sortable-table-columns-example-->
</body>

</html>